/*!
 * dejavu.js v 0.1.0
 * http://github.com/composite/Dejavu.js/
 *
 *
 * Copyright 2016 Ukjin 'Composite' Yang.
 * Released under the MIT license
 * http://github.com/composite/Dejavu.js/LICENSE
 *
 */
!function(a,b){"use strict";var c=function(a){return"function"==typeof a};c(a.CustomEvent)&&(a.CustomEvent=function(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var g,d=!!b.bubbles,e=!!b.cancelable,f=b.detail;return c(document.createEvent)?(g=document.createEvent("CustomEvent"),g.initCustomEvent(a,d,e,f)):(g=document.createEventObject(),g.bubbles=d,g.cancelable=e,g.detail=f),g});var d=void 0,e="addEventListener",f="",g=function(a){return a.length===[].slice.call(a,0).length},h=function(a,d){var e=b.createElement(a);return c(d)&&d.call(e,a),e},i={ev:"DEJAVU_SCROLLEV",ch:"DEJAVU_CHILDREN",op:"DEJAVU_OPTION",po:"DEJAVU_POSITION",on:"DEJAVU_EVENT"},j=[],k=function(a,b,c){for(var d=0,e=a.length;e>a;a++)if(c?a[d]===b:a[d]==b)return d;return-1},l=function(a){return"string"==typeof a||a instanceof String},m=function(){return{x:a.scrollX||a.pageXOffset||b.documentElement.scrollLeft||b.body.scrollLeft,y:a.scrollY||a.pageYOffset||b.documentElement.scrollTop||b.body.scrollTop}},n=function(b){a.Dejavu.debug&&console.debug(b)},o=screen.availWidth,p=screen.availHeight,q=function(a,b,d){return c(a.dispatchEvent)?a.dispatchEvent(d):a.fireEvent(b,d)},r={enable:function(a){return n(this[i.po].ENABLE=!!a),this.dejavu},random:function(a){return a!==d?n(this[i.po].RANDOM=!!a):this.dejavu.render(~~(Math.random()*this[i.po].LENGTH)),this.dejavu},next:function(){return n(this[i.po].CURRENT++),this[i.po].CURRENT==this[i.po].LENGTH&&(this[i.po].CURRENT=0),this.dejavu.render()},prev:function(){return n(this[i.po].CURRENT--),this[i.po].CURRENT<0&&(this[i.po].CURRENT=this[i.po].LENGTH-1),this.dejavu.render()},render:function(a){a=isNaN(a)?this[i.po].CURRENT:~~a;for(var b=0,c=this[i.ch],d=c.length;d>b;b++){if(c[b].parentNode!=this)return n(c[b]),n("[DEJAVU] has been removed from parent. updating..."),this.dejavu.update(),this.dejavu.prev();b!=a?c[b].setAttribute("hidden","hidden"):c[b].removeAttribute("hidden","hidden")}return this.dejavu},shuffle:function(){return this[i.ch].sort(function(){return~~(3*Math.random())-1}),this.dejavu},sort:function(a){return this[i.ch].sort(a),this.dejavu},destroy:function(){return a.Dejavu.destroy(this)},update:function(a){a!==d&&(this[i.po].UPDATE=!!a),this[i.ch].length=0;for(var b=0,c=this.childNodes,e=c.length;e>b;b++)1==c[b].nodeType&&(b!=this[i.po].CURRENT?c[b].setAttribute("hidden","hidden"):c[b].removeAttribute("hidden","hidden"),this[i.ch].push(c[b]));this[i.po].LENGTH=this[i.ch].length,n("[DEJAVU] updated as"),n(this[i.ch]);var f=this;return setTimeout(function(){var a=f.getBoundingClientRect(),b=m();f[i.po].MODEL=f[i.po].MODEL||{},f[i.po].MODEL.top=a.top+b.y,f[i.po].MODEL.bottom=a.bottom+b.y,f[i.po].MODEL.left=a.left+b.x,f[i.po].MODEL.right=a.right+b.x,n(f[i.po].MODEL)},0),this.dejavu.emit("update"),this.dejavu},on:function(a,b){return a in this[i.po].EVENT&&c(b)&&this[i.po].EVENT[a].push(b),this.dejavu},off:function(a,b){var c;return a in this[i.po].EVENT&&~(c=k(this[i.po].EVENT[a],b))&&this[i.po].EVENT[a].splice(c,1),this.dejavu},emit:function(b){if(b in this[i.po].EVENT){[].shift.call(arguments);var d=arguments,e=a.CustomEvent(i.on,{detail:{args:d,type:b,position:this[i.po].MODEL,current:this[i.po].CURRENT,length:this[i.po].LENGTH,inside:this[i.po].STATUS,enable:this[i.po].ENABLED}});q(this,f+i.on,e)}}};"undefined"==typeof b.hidden&&b.getElementsByTagName("head")[0].appendChild(h("style",function(){this.innerHTML="*[hidden]{display:none;}"}));var s=function(d,h){if(!d)throw new Error("dejavu element(s) are not defined.");h=h||a.Dejavu.options,l(d)&&(d=b.querySelectorAll(d)||b.getElementById(d));var m=d,q=function(a,b,c){a.dejavu[c]=function(){return b[c].apply(a,arguments)}};g(d)||(d=[d]),n("[DEJAVU] Dejavu initialize"),n(d),n(h);for(var s=0,t=d.length;t>s;s++)if(d[s]&&!~k(j,d[s])&&1==d[s].nodeType){d[s][i.ch]=[],d[s][i.op]=h,d[s][i.ev]=function(a,b){var c=this[i.po];b+p-c.MARGIN>c.MODEL.top&&b-c.MARGIN<c.MODEL.bottom&&a+o-c.MARGIN>c.MODEL.left&&a-c.MARGIN<c.MODEL.right?c.STATUS||(c.STATUS=!0,n("[DEJAVU] in your eye side."),this.dejavu.emit("inside",a,b)):c.STATUS&&(c.STATUS=!1,n("[DEJAVU] out of your eye side."),c.RANDOM?this.dejavu.random():this.dejavu.next(),this.dejavu.emit("outside",a,b))},d[s].dejavu={};for(var u in r)q(d[s],r,u);for(var u in a.Dejavu.fn)q(d[s],a.Dejavu.fn,u);d[s][i.po]={CURRENT:0,LENGTH:0,STATUS:!1,ENABLED:"enable"in h?!!h.enable:a.Dejavu.options.enable,RANDOM:"random"in h?!!h.random:a.Dejavu.options.random,MARGIN:isNaN(h.margin)?a.Dejavu.options.margin:h.margin,MODEL:{top:0,bottom:0,right:0,left:0},UPDATE:"update"in h?!!h.update:a.Dejavu.options.update,EVENT:{inside:[],outside:[],update:[]}};for(var v in d[s][i.po].EVENT)c(h["on"+v])&&d[s][i.po].EVENT[v].push(h["on"+v]);d[s].dejavu.update(),d[s].dejavu.render(),!function(b){d[s][e](f+i.on,function(d){if(d||(d=a.event,d.currentTarget=b,d.preventDefault=function(){event.returnValue=!1},d.stopPropagation=function(){event.cancelBubble=!0},d.target=event.srcElement||b),d.detail.type in b[i.po].EVENT)for(var e=0,f=b[i.po].EVENT[d.detail.type],g=f.length;g>e;e++)!function(a,e){c(e)&&e.apply(b,d)}(e,f[e])})}(d[s]),j.push(d[s]),c(h.oninit)&&h.oninit.call(d[s],h)}return m};return s.destroy=function(a){var b=a;g(a)||(a=[a]),n("[DEJAVU] Dejavu destroying"),n(a);for(var c=0,e=a.length;e>c;c++)if(~k(j,a[c])){for(var f=0,h=a[c].childNodes,l=h.length;l>f;f++)1==h.nodeType&&h[f].removeAttribute("hidden");a[c].dejavu=d;for(var m in i)a[c][i[m]]=d;j.splice(k(a[c]),1)}return b},s.options={enable:!0,random:!1,shuffle:!1,update:!1,oninit:null,onoutside:null,oninside:null,onupdate:null,sort:null,margin:10},s.debug=!1,s.fn={},a[e](f+"scroll",function(b){b=b||a.event;for(var c=m(),d=0,e=j,f=e.length;f>d;d++)e[d][i.ev].call(e[d],c.x,c.y)}),a[e](f+"resize",function(){o=screen.availWidth,p=screen.availHeight}),a.Dejavu=s}(window,document);